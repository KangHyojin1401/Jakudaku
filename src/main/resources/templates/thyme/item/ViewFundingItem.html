<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>펀딩 상품 상세페이지</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css" integrity="sha512-8bHTC73gkZ7rZ7vpqUQThUDhqcNFyYi2xgDgPDHc+GXVGHXq+xPjynxIopALmOPqzo9JZj0k6OqqewdGO3EsrQ==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/components/button.min.css" integrity="sha512-OD0ScwZAE5PCg4nATXnm8pdWi0Uk0Pp2XFsFz1xbZ7xcXvapzjvcxxHPeTZKfMjvlwwl4sGOvgJghWF2GRZZDw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/components/sticky.min.css" integrity="sha512-zF2HEUhQSw0Cb7RtcIc9qx8SKuAvNl8wzA542h55r+COkQ/xBkkcMvqdzQ9NApKQxiluCRmmjFAs5oDlTPsOOw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/components/menu.min.css" integrity="sha512-ox96Q1iqhM5TvdY4gVbz6FXoDwsR/Q8jq15kWReQNefC+uUGCv+pkMbLOtr176K3+bfrQQv6gTDAvhL1PUw2YQ==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/components/item.min.css" integrity="sha512-FegoQ4GicaEtaxCERXNNFN0eloN0wsebNJ8E0kwIJSKBGgfNWFhO0oQhzVPywJt19SwiF4eN/CvDvIKhgIyuhw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/components/tab.min.css" integrity="sha512-NxWghIwNoV7V1IAHt4HwVnmsG/FuuViHaXFP0tsZS0D9snWm4SLGSdfB5XogpAWYXabp2t+XY9L184PQg2IuEA==" crossorigin="anonymous" referrerpolicy="no-referrer" />

<!-- jQuery 1.8 or later, 33 KB -->
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"
	type="text/javascript"></script>
<!-- Fotorama from CDNJS, 19 KB -->
<link
	href="https://cdnjs.cloudflare.com/ajax/libs/fotorama/4.6.4/fotorama.css"
	rel="stylesheet" />
	


<style type="text/css">
.ui.fixed.sticky + p {
  margin-top: 39px;
}

.order {
  color: white;
  background-color: transparent;
  text-decoration: none;
}

.order:hover {
	color: white;
  	background-color: transparent;
  	text-decoration: none;
}

.ui.attached.button {
	width: 30px;
}

.ui.attached.left.button {
	padding-left: 0px;
	padding-right: 0px;
 	text-align: center;
 	width: 30px;
 	vertical-align: middle;	
}

.ui.attached.right.button {
	padding-left: 0px;
	padding-right: 0px;
 	text-align: center;
 	width: 30px;
 	vertical-align: middle;
}

#option {
  	display: inline-flex;  
	vertical-align: middle;
 	border: 0px; 
  	line-height:35px;  
	align-items: center;
	text-align: center;
 	width: 50px; 
}

#option:focus {
	outline: none;
	box-shadow: 0 0 0 1px gray inset; 
	border-radius: 3px;
}

</style>

<script type="text/javascript">
	//옵션 수량 변경
	function calc(btn) {
		var option = $('#option');
		
		if (option.val() > 0 && btn.id == 'option_minus') {
			option.val(option.val() - 1);
		}	
		
		if (btn.id == 'option_plus') {
			option.val(option.val() * 1 + 1);
		}
	};
</script>
</head>
<body>

	<!-- 상품 미리보기 -->
	<div th:object="${funding}">
		<div class="fotorama" data-width="300" data-ratio="3/2"
			data-nav="thumbs" data-thumbheight="48">
			<a href="http://s.fotorama.io/okonechnikov/1-lo.jpg"><img src="" width="144" height="96" alt=""></a>
			<a href="http://s.fotorama.io/okonechnikov/2-lo.jpg"><img src="" width="144" height="96" alt=""></a>
			<a href="http://s.fotorama.io/okonechnikov/3-lo.jpg"><img src="" height="96" alt=""></a>
		</div>
		<p><span th:text="*{name}">솜솜 쿠션!</span></p>
		<p><span th:text="*{price} + '원'">30000원</span></p>

		<div class="ui labeled button" tabindex="0">
 			<div class="ui basic red button">
    		<i class="heart icon"></i> Like
  			</div>
  			<a class="ui basic red left pointing label"><span th:text="*{likeNum}">1048</span></a> <!-- 눌렀을 때 toggle 처리는 js로 & db에 어떻게 들어가게 할건지..? 누를 때마다 페이지가 새로고침될 순 없으니까 -->
		</div>
		
		<div class="ui labeled button" tabindex="0">
 			<div class="ui red button">
    		<i class="heart icon"></i> Like
  			</div>
  			<a class="ui basic red left pointing label"><span th:text="*{likeNum}">1048</span></a> <!-- 눌렀을 때 toggle 처리는 js로 & db에 어떻게 들어가게 할건지..? 누를 때마다 페이지가 새로고침될 순 없으니까 -->
		</div>
		
		<p>펀딩 종료 시간 <span th:text="*{finishDate}"></span></p>
		<p><span id="remaining_time"> </span></p>
		
		<div class="ui indicating progress" data-value="60" th:attr="data-value=*{quantityPercentage}" data-total="100" id="example5">
  			<div class="bar">
  				<div class="progress"></div>
  			</div>
  			<div class="label"><span th:text="*{quantityPercentage} + '% 달성!'"></span></div>
		</div>
		
		<p>
			<span>목표 달성률 </span>
			<span th:text="*{purchaseQuantity} + ' / ' + *{targetQuantity} + ' 개'">구매 수량 / 목표수량 개</span>
		</p>
	
		<form action="#" th:action="@{/order/newFundOrder.do}" method="get">			
			<input type="hidden" th:field="${funding.itemId}"/>
			<p>
			수량 
			<div id="wrap_option">
				<button type="button" class="left attached ui button" id="option_minus" onClick="calc(this)">-</button>
				<input type="text" value="0" id="option" name="quantity" pattern="[0-9]+"/>
				<button type="button" class="right attached ui button" id="option_plus" onClick="calc(this)">+</button>
			</div>
			<br>
			<input class="ui large red button" type="submit" value="펀딩하기">
		</form>
		
		
		<div class="ui segment">
	  		<div class="ui sticky" style="width: 670px !important; height: 42.6px !important; left: 417.8px;">
	    		<div class="ui fluid two item tabular menu">
	      		<a class="active item" data-tab="description_tab">상세설명</a>
	      		<a class="item" data-tab="refund_tab">환불 안내</a>
	    		</div>
			</div>
			<div class="ui active tab">
			    <div class="ui active tab" data-tab="description_tab">
				    <p><a id="description">상세 설명 시작</a></p>
				    <p><span th:text="*{description}"></span></p>
				    
				</div>
				
				<div class="ui tab" data-tab="refund_tab">
				    <p><a id="refund">환불 안내 시작</a></p>
				</div>
			</div>
		</div>
	</div>
	
	
	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.js" integrity="sha512-dqw6X88iGgZlTsONxZK9ePmJEFrmHwpuMrsUChjAw1mRUhUITE5QU9pkcSox+ynfLhL15Sv2al5A0LVyDCmtUw==" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/components/sticky.min.js" integrity="sha512-sWpXObBFGM42aj1IMnpgU4aUY5K3MYAmvR2QeVAo4zorR/IrNxIW1E9sAp95AKZ9TUGuxItlzCxZdLchz/rkoA==" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/components/tab.min.js" integrity="sha512-XKGavlXNr1OAZcYLtNBQA4oyuagTLY6t+bhOtR9PZNxSdFwGN+UX44izGw9+eDOnBHbf9sZJKEZ1OdVxNeXvaA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script
	src="https://cdnjs.cloudflare.com/ajax/libs/fotorama/4.6.4/fotorama.js"
	type="text/javascript"></script>
	<script th:inline="javascript">
	$('.ui.sticky')
	  .sticky()
	;
	
	$('#example5').progress();
	
	$('.menu .item').tab();
	
// 	$('#example5')
// 	  .progress({
// 	    text: {
// 	      active  : 'Adding {value} of {total} photos',
// 	      success : '{total} Photos Uploaded!'
// 	    }
// 	  })
// 	;

	//펀딩 남은 시간 타이머
	const countDownTimer = function (id, date) { 
		var _vDate = new Date(date); // 전달 받은 일자 
		var _second = 1000; 
		var _minute = _second * 60; 
		var _hour = _minute * 60; 
		var _day = _hour * 24; 
		var timer; 
		
		function showRemaining() { 
			var now = new Date(); 
			var distDt = _vDate - now; 
			
			if (distDt < 0) { 
				clearInterval(timer); 
				$('#text_remain').text('');
				document.getElementById(id).textContent = '펀딩이 종료 되었습니다.'; 
				return; 
			} 
			
			var days = Math.floor(distDt / _day); 
			var hours = Math.floor((distDt % _day) / _hour); 
			var minutes = Math.floor((distDt % _hour) / _minute); 
			var seconds = Math.floor((distDt % _minute) / _second); 
			
			//document.getElementById(id).textContent = date.toLocaleString() + "까지 : "; 
			document.getElementById(id).textContent = days + '일 '; 
			document.getElementById(id).textContent += hours + '시간 '; 
			document.getElementById(id).textContent += minutes + '분 '; 
			document.getElementById(id).textContent += seconds + '초 남았습니다.'; 
			
			if (hours <= 0) {
				$(id).css("color", "red");
			}
		} 
		
		timer = setInterval(showRemaining, 1000); 
	}

	$(function() {
	    countDownTimer('remaining_time', /*[[${funding.finishDate}]]*/ null); 
	});
	
// 	console.log(/*[[${funding}]]*/);

	//옵션 수량 height 설정
	$('#option').css('height', $('.ui.attached.button').css('height'));
	</script>
</body>
</html>